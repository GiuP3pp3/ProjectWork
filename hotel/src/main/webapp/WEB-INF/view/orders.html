<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="it" class="h-100">
	<head th:replace="../template/base-template :: headFragment"></head>
	<body class="d-flex flex-column h-100">
		<div class="container">
			<nav th:replace="../template/base-template :: navFragment"></nav>
			<div th:replace="../template/base-template :: headerFragment"></div>		
			<div class="row mt-4">
				<div class="col-12 text-center">
					<h4 th:text="#{label.ordersmanagement}"></h4>
				</div>
			</div>
			<div class="row mt-4">
				<div class="col-7">
					<table class="table table-striped table-responsive">
						<thead>
							<tr>
								<th th:text="#{label.orderdate}"></th>
								<th th:text="#{label.orderamount}"></th>
								<th th:text="#{label.ordercustomersurname}"></th>
								<th th:text="#{label.ordercustomerfiscalcode}"></th>
								<th></th>
							</tr>
						</thead>
						<tbody>
							<tr th:each="o : ${orders}">
								<td th:text="${#dates.format(o.date, 'dd-MM-yyyy')}"></td>
								<td th:text="'Euro ' + ${#numbers.formatDecimal(o.amount,0,'POINT',2,'COMMA')}"></td>
								<td th:text="${o.customer.surname}"></td>
								<td th:text="${o.customer.fiscalCode}"></td>
								<td class="text-end">
									<a th:href="@{/orders(id=${o.id})}" class="btn btn-primary btn-sm small-button" 
										th:text="#{btn.edit}"></a>
									<a th:href="@{orders/deleteorder(id=${o.id})}" class="btn btn-danger btn-sm small-button" 
										th:text="#{btn.delete}"></a>
								</td>
							</tr>
						</tbody>
					</table>
				</div>
				<div class="col-1"></div>
				<div class="col-4">
					<form action="orders/saveorder" method="POST">
						<div class="row">
							<div class="col-12">
								<label for="date" th:text="#{label.orderdate} + ':'"></label>
								<input type="date" id="date" name="date" th:value="${order.date}"
									class="form-control" required="required">
							</div>
						</div>
						<div class="row">
							<div class="col-12">
								<label for="selCustomer" th:text="#{label.customer} + ':'"></label>
								<select id="selCustomer" name="selCustomer" class="form-select">
									<option th:each="c : ${customers}" th:value="${c.id}"
										th:text="${c.surname}"
										th:selected="${order.customer != null AND c.id == order.customer.id}">
									</option>
								</select>
							</div>
						</div>
						<div class="row">
							<div class="col-12">
								<label th:text="#{label.includedarticles} + ':'"></label>
								<div th:each="a : ${articles}" class="form-check">
									<input type="checkbox" name="orderArticles" th:value="${a.id}"
										class="form-check-input" th:checked= "${a.included}">
									<label class="form-check-label" th:text="${a.description}"></label>
								</div>
							</div>
						</div>
						<div class="row mt-4">
							<div class="col-12 text-center">
								<input type="submit" th:value="#{btn.register}" class="btn btn-primary large-button">
							</div>
						</div>
					</form>
				</div>
			</div>
		</div>
	</body>
	<footer th:replace="../template/base-template :: footerFragment"></footer>
</html>